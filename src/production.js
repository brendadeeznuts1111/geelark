#!/usr/bin/env bun
// @bun
var v=(E=0)=>(I)=>`\x1B[${I+E}m`,u=(E=0)=>(I)=>`\x1B[${38+E};5;${I}m`,y=(E=0)=>(I,T,A)=>`\x1B[${38+E};2;${I};${T};${A}m`,C={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},HE=Object.keys(C.modifier),l=Object.keys(C.color),a=Object.keys(C.bgColor),SE=[...l,...a];function e(){let E=new Map;for(let[I,T]of Object.entries(C)){for(let[A,N]of Object.entries(T))C[A]={open:`\x1B[${N[0]}m`,close:`\x1B[${N[1]}m`},T[A]=C[A],E.set(N[0],N[1]);Object.defineProperty(C,I,{value:T,enumerable:!1})}return Object.defineProperty(C,"codes",{value:E,enumerable:!1}),C.color.close="\x1B[39m",C.bgColor.close="\x1B[49m",C.color.ansi=v(),C.color.ansi256=u(),C.color.ansi16m=y(),C.bgColor.ansi=v(10),C.bgColor.ansi256=u(10),C.bgColor.ansi16m=y(10),Object.defineProperties(C,{rgbToAnsi256:{value(I,T,A){if(I===T&&T===A){if(I<8)return 16;if(I>248)return 231;return Math.round((I-8)/247*24)+232}return 16+36*Math.round(I/255*5)+6*Math.round(T/255*5)+Math.round(A/255*5)},enumerable:!1},hexToRgb:{value(I){let T=/[a-f\d]{6}|[a-f\d]{3}/i.exec(I.toString(16));if(!T)return[0,0,0];let[A]=T;if(A.length===3)A=[...A].map((O)=>O+O).join("");let N=Number.parseInt(A,16);return[N>>16&255,N>>8&255,N&255]},enumerable:!1},hexToAnsi256:{value:(I)=>C.rgbToAnsi256(...C.hexToRgb(I)),enumerable:!1},ansi256ToAnsi:{value(I){if(I<8)return 30+I;if(I<16)return 90+(I-8);let T,A,N;if(I>=232)T=((I-232)*10+8)/255,A=T,N=T;else{I-=16;let D=I%36;T=Math.floor(I/36)/5,A=Math.floor(D/6)/5,N=D%6/5}let O=Math.max(T,A,N)*2;if(O===0)return 30;let R=30+(Math.round(N)<<2|Math.round(A)<<1|Math.round(T));if(O===2)R+=60;return R},enumerable:!1},rgbToAnsi:{value:(I,T,A)=>C.ansi256ToAnsi(C.rgbToAnsi256(I,T,A)),enumerable:!1},hexToAnsi:{value:(I)=>C.ansi256ToAnsi(C.hexToAnsi256(I)),enumerable:!1}}),C}var EE=e(),H=EE;import b from"process";import IE from"os";import i from"tty";function P(E,I=globalThis.Deno?globalThis.Deno.args:b.argv){let T=E.startsWith("-")?"":E.length===1?"-":"--",A=I.indexOf(T+E),N=I.indexOf("--");return A!==-1&&(N===-1||A<N)}var{env:G}=b,q;if(P("no-color")||P("no-colors")||P("color=false")||P("color=never"))q=0;else if(P("color")||P("colors")||P("color=true")||P("color=always"))q=1;function TE(){if("FORCE_COLOR"in G){if(G.FORCE_COLOR==="true")return 1;if(G.FORCE_COLOR==="false")return 0;return G.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(G.FORCE_COLOR,10),3)}}function AE(E){if(E===0)return!1;return{level:E,hasBasic:!0,has256:E>=2,has16m:E>=3}}function NE(E,{streamIsTTY:I,sniffFlags:T=!0}={}){let A=TE();if(A!==void 0)q=A;let N=T?q:A;if(N===0)return 0;if(T){if(P("color=16m")||P("color=full")||P("color=truecolor"))return 3;if(P("color=256"))return 2}if("TF_BUILD"in G&&"AGENT_NAME"in G)return 1;if(E&&!I&&N===void 0)return 0;let O=N||0;if(G.TERM==="dumb")return O;if(b.platform==="win32"){let R=IE.release().split(".");if(Number(R[0])>=10&&Number(R[2])>=10586)return Number(R[2])>=14931?3:2;return 1}if("CI"in G){if(["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some((R)=>(R in G)))return 3;if(["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some((R)=>(R in G))||G.CI_NAME==="codeship")return 1;return O}if("TEAMCITY_VERSION"in G)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(G.TEAMCITY_VERSION)?1:0;if(G.COLORTERM==="truecolor")return 3;if(G.TERM==="xterm-kitty")return 3;if(G.TERM==="xterm-ghostty")return 3;if(G.TERM==="wezterm")return 3;if("TERM_PROGRAM"in G){let R=Number.parseInt((G.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(G.TERM_PROGRAM){case"iTerm.app":return R>=3?3:2;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(G.TERM))return 2;if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(G.TERM))return 1;if("COLORTERM"in G)return 1;return O}function f(E,I={}){let T=NE(E,{streamIsTTY:E&&E.isTTY,...I});return AE(T)}var OE={stdout:f({isTTY:i.isatty(1)}),stderr:f({isTTY:i.isatty(2)})},d=OE;function h(E,I,T){let A=E.indexOf(I);if(A===-1)return E;let N=I.length,O=0,R="";do R+=E.slice(O,A)+I+T,O=A+N,A=E.indexOf(I,O);while(A!==-1);return R+=E.slice(O),R}function c(E,I,T,A){let N=0,O="";do{let R=E[A-1]==="\r";O+=E.slice(N,R?A-1:A)+I+(R?`\r
`:`
`)+T,N=A+1,A=E.indexOf(`
`,N)}while(A!==-1);return O+=E.slice(N),O}var{stdout:n,stderr:o}=d,w=Symbol("GENERATOR"),K=Symbol("STYLER"),z=Symbol("IS_EMPTY"),s=["ansi","ansi","ansi256","ansi16m"],X=Object.create(null),RE=(E,I={})=>{if(I.level&&!(Number.isInteger(I.level)&&I.level>=0&&I.level<=3))throw Error("The `level` option should be an integer from 0 to 3");let T=n?n.level:0;E.level=I.level===void 0?T:I.level};var _E=(E)=>{let I=(...T)=>T.join(" ");return RE(I,E),Object.setPrototypeOf(I,Y.prototype),I};function Y(E){return _E(E)}Object.setPrototypeOf(Y.prototype,Function.prototype);for(let[E,I]of Object.entries(H))X[E]={get(){let T=B(this,W(I.open,I.close,this[K]),this[z]);return Object.defineProperty(this,E,{value:T}),T}};X.visible={get(){let E=B(this,this[K],!0);return Object.defineProperty(this,"visible",{value:E}),E}};var L=(E,I,T,...A)=>{if(E==="rgb"){if(I==="ansi16m")return H[T].ansi16m(...A);if(I==="ansi256")return H[T].ansi256(H.rgbToAnsi256(...A));return H[T].ansi(H.rgbToAnsi(...A))}if(E==="hex")return L("rgb",I,T,...H.hexToRgb(...A));return H[T][E](...A)},DE=["rgb","hex","ansi256"];for(let E of DE){X[E]={get(){let{level:T}=this;return function(...A){let N=W(L(E,s[T],"color",...A),H.color.close,this[K]);return B(this,N,this[z])}}};let I="bg"+E[0].toUpperCase()+E.slice(1);X[I]={get(){let{level:T}=this;return function(...A){let N=W(L(E,s[T],"bgColor",...A),H.bgColor.close,this[K]);return B(this,N,this[z])}}}}var CE=Object.defineProperties(()=>{},{...X,level:{enumerable:!0,get(){return this[w].level},set(E){this[w].level=E}}}),W=(E,I,T)=>{let A,N;if(T===void 0)A=E,N=I;else A=T.openAll+E,N=I+T.closeAll;return{open:E,close:I,openAll:A,closeAll:N,parent:T}},B=(E,I,T)=>{let A=(...N)=>GE(A,N.length===1?""+N[0]:N.join(" "));return Object.setPrototypeOf(A,CE),A[w]=E,A[K]=I,A[z]=T,A},GE=(E,I)=>{if(E.level<=0||!I)return E[z]?"":I;let T=E[K];if(T===void 0)return I;let{openAll:A,closeAll:N}=T;if(I.includes("\x1B"))while(T!==void 0)I=h(I,T.close,T.open),T=T.parent;let O=I.indexOf(`
`);if(O!==-1)I=c(I,N,A,O);return A+I+N};Object.defineProperties(Y.prototype,X);var ME=Y(),mE=Y({level:o?o.level:0});var _=ME;class ${static FLAG_EMOJI_REGEX=/\p{Emoji}\uFE0F?\u200D?\p{Emoji}/u;static ZWJ_SEQUENCE_REGEX=/\p{Emoji}(\u200D\p{Emoji})+/u;static VARIATION_SELECTOR_REGEX=/\p{Emoji}\uFE0E|\p{Emoji}\uFE0F/gu;static ANSI_ESCAPE_REGEX=/\x1b\[[0-9;]*[mG]/g;static ZERO_WIDTH_CHARS=/\u200B|\u200C|\u200D|\uFEFF/g;static SOFT_HYPHEN=/\u00AD/g;static EAST_ASIAN_WIDE=/[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\u9FFF\uA000-\uA48F\uA490-\uA4CF\uA960-\uA97F\uAC00-\uD7AF\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]/g;static ANSI_HYPERLINK_REGEX=/\x1b\]8;;[^\x1b]*\x1b\\\x1b\]8;;\x1b\\/g;static calculate(E){if(!E)return 0;let I=0,T=0;while(T<E.length){let A=E.codePointAt(T);if(A===void 0)break;let N=String.fromCodePoint(A),O=this.getCharWidth(N,E,T);I+=O,T+=N.length}return I}static getCharWidth(E,I,T){if(this.ANSI_ESCAPE_REGEX.test(E))return 0;if(this.ZERO_WIDTH_CHARS.test(E))return 0;let A=I.substring(T).match(this.ANSI_HYPERLINK_REGEX);if(A&&A.index===0){let N=A[0].replace(this.ANSI_HYPERLINK_REGEX,(O)=>{let R=O.split("\x1B\\");return R.length>1?R[0].split(";")[2]||"":""});return this.calculate(N)}if(this.isFlagEmoji(E,I,T))return 2;if(this.isZWJSequence(I,T))return 2;if(this.isSkinToneModifier(E))return 0;if(this.isVariationSelector(E))return 0;if(this.isCombiningMark(E))return 0;if(E==="\xAD")return 0;if(this.EAST_ASIAN_WIDE.test(E))return 2;if(this.isEmoji(E))return 2;if(this.isControlCharacter(E))return 0;return 1}static isFlagEmoji(E,I,T){if(T+1<I.length){let A=I[T+1],N=E.codePointAt(0),O=A.codePointAt(0);if(N&&O&&N>=127462&&N<=127487&&O>=127462&&O<=127487)return!0}return/\p{Emoji_Presentation}\p{Emoji_Presentation}/.test(E)||/\p{Emoji}\uFE0F/.test(E)}static isZWJSequence(E,I){let T="",A=I;while(A<E.length){let N=E.codePointAt(A);if(!N)break;let O=String.fromCodePoint(N);if(T+=O,O==="\u200D"&&A+1<E.length){let R=E.codePointAt(A+1);if(R&&this.isEmoji(String.fromCodePoint(R))){A+=String.fromCodePoint(R).length;continue}}if(!this.isEmoji(O)&&O!=="\u200D"&&O!=="\uFE0F")break;if(A+=O.length,T.length>20)break}return T.includes("\u200D")&&T.length>1}static isSkinToneModifier(E){let I=E.codePointAt(0);return I!==void 0&&I>=127995&&I<=127999}static isVariationSelector(E){let I=E.codePointAt(0);return I!==void 0&&(I===65038||I===65039)}static isCombiningMark(E){let I=E.codePointAt(0);if(!I)return!1;return I>=768&&I<=879||I>=6832&&I<=6911||I>=7616&&I<=7679||I>=8400&&I<=8447||I>=65056&&I<=65071}static isEmoji(E){let I=E.codePointAt(0);if(!I)return!1;return I>=128512&&I<=128591||I>=127744&&I<=128511||I>=128640&&I<=128767||I>=127456&&I<=127487||I>=9728&&I<=9983||I>=9984&&I<=10175||I>=129318&&I<=129335||I>=129336&&I<=129342||I>=129343&&I<=129359||I>=129360&&I<=129391||I>=129392&&I<=129407||I>=129408&&I<=129471||I>=129472&&I<=129487||I>=129488&&I<=129535}static isControlCharacter(E){let I=E.codePointAt(0);return I!==void 0&&I<32}static truncate(E,I,T="..."){if(this.calculate(E)<=I)return E;let A="",N=0;for(let O=0;O<E.length;O++){let R=E[O],D=this.getCharWidth(R,E,O);if(N+D+this.calculate(T)>I)break;A+=R,N+=D}return A+T}static padEnd(E,I,T=" "){let A=this.calculate(E);if(A>=I)return E;let N=I-A;return E+T.repeat(N)}static padStart(E,I,T=" "){let A=this.calculate(E);if(A>=I)return E;let N=I-A;return T.repeat(N)+E}static center(E,I,T=" "){let A=this.calculate(E);if(A>=I)return E;let N=I-A,O=Math.floor(N/2),R=N-O;return T.repeat(O)+E+T.repeat(R)}static wrap(E,I){let T=[],A=E.split(/\s+/),N="",O=0;for(let R of A){let D=this.calculate(R),M=N?1:0;if(O+M+D<=I)if(N)N+=" "+R,O+=M+D;else N=R,O=D;else{if(N)T.push(N);N=R,O=D}}if(N)T.push(N);return T}}var jE=$.calculate;var V;((U)=>{U.ENV_DEVELOPMENT="ENV_DEVELOPMENT";U.ENV_PRODUCTION="ENV_PRODUCTION";U.FEAT_PREMIUM="FEAT_PREMIUM";U.FEAT_AUTO_HEAL="FEAT_AUTO_HEAL";U.FEAT_NOTIFICATIONS="FEAT_NOTIFICATIONS";U.FEAT_ENCRYPTION="FEAT_ENCRYPTION";U.FEAT_MOCK_API="FEAT_MOCK_API";U.FEAT_EXTENDED_LOGGING="FEAT_EXTENDED_LOGGING";U.FEAT_ADVANCED_MONITORING="FEAT_ADVANCED_MONITORING";U.FEAT_BATCH_PROCESSING="FEAT_BATCH_PROCESSING";U.FEAT_VALIDATION_STRICT="FEAT_VALIDATION_STRICT";U.PLATFORM_ANDROID="PLATFORM_ANDROID";U.INTEGRATION_GEELARK_API="INTEGRATION_GEELARK_API";U.INTEGRATION_PROXY_SERVICE="INTEGRATION_PROXY_SERVICE";U.INTEGRATION_EMAIL_SERVICE="INTEGRATION_EMAIL_SERVICE";U.INTEGRATION_SMS_SERVICE="INTEGRATION_SMS_SERVICE"})(V||={});var Z;((D)=>{D.FEATURE_CHANGE="FEATURE_CHANGE";D.SECURITY_EVENT="SECURITY_EVENT";D.INTEGRATION_EVENT="INTEGRATION_EVENT";D.PERFORMANCE_METRIC="PERFORMANCE_METRIC";D.ERROR_OCCURRED="ERROR_OCCURRED";D.AUDIT_TRAIL="AUDIT_TRAIL";D.HEALTH_CHECK="HEALTH_CHECK"})(Z||={});var m;((O)=>{O.DEBUG="DEBUG";O.INFO="INFO";O.WARN="WARN";O.ERROR="ERROR";O.CRITICAL="CRITICAL"})(m||={});var Q;((R)=>{R.DEVELOPMENT="DEVELOPMENT";R.PRODUCTION_LITE="PRODUCTION_LITE";R.PRODUCTION_STANDARD="PRODUCTION_STANDARD";R.PRODUCTION_PREMIUM="PRODUCTION_PREMIUM";R.TEST="TEST";R.AUDIT="AUDIT"})(Q||={});var j={ENV_DEVELOPMENT:{flag:"ENV_DEVELOPMENT",criticalLevel:"CRITICAL",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83C\uDF0D DEV",badgeDisabled:"\uD83C\uDF0D PROD",buildTimeImpact:"+15% size"},ENV_PRODUCTION:{flag:"ENV_PRODUCTION",criticalLevel:"CRITICAL",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83C\uDF0D PROD",badgeDisabled:"\uD83C\uDF0D DEV",buildTimeImpact:"-25% size"},FEAT_PREMIUM:{flag:"FEAT_PREMIUM",criticalLevel:"HIGH",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83C\uDFC6 PREMIUM",badgeDisabled:"\uD83D\uDD13 FREE",buildTimeImpact:"+15% size",memoryImpact:"+15%",cpuImpact:"+5%",bundleSizeImpact:"+12%",startupTimeImpact:"+200ms"},FEAT_AUTO_HEAL:{flag:"FEAT_AUTO_HEAL",criticalLevel:"HIGH",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83D\uDD04 AUTO-HEAL",badgeDisabled:"\u26A0\uFE0F MANUAL",buildTimeImpact:"+10% size",memoryImpact:"+8%",cpuImpact:"+3%",bundleSizeImpact:"+10%",startupTimeImpact:"+150ms"},FEAT_NOTIFICATIONS:{flag:"FEAT_NOTIFICATIONS",criticalLevel:"MEDIUM",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83D\uDD14 ACTIVE",badgeDisabled:"\uD83D\uDD15 SILENT",buildTimeImpact:"+8% size",memoryImpact:"+3%",cpuImpact:"+2%",bundleSizeImpact:"+8%",startupTimeImpact:"+50ms"},FEAT_ENCRYPTION:{flag:"FEAT_ENCRYPTION",criticalLevel:"CRITICAL",logHook:"SECURITY_EVENT",badgeEnabled:"\uD83D\uDD10 ENCRYPTED",badgeDisabled:"\u26A0\uFE0F PLAINTEXT",buildTimeImpact:"+5% size",memoryImpact:"+10%",cpuImpact:"+8%",bundleSizeImpact:"+5%",startupTimeImpact:"+300ms"},FEAT_MOCK_API:{flag:"FEAT_MOCK_API",criticalLevel:"PROD_CRITICAL",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83E\uDDEA MOCK",badgeDisabled:"\uD83D\uDE80 REAL",buildTimeImpact:"-20% size",memoryImpact:"-30%",cpuImpact:"-40%",bundleSizeImpact:"-20%",startupTimeImpact:"-100ms"},FEAT_EXTENDED_LOGGING:{flag:"FEAT_EXTENDED_LOGGING",criticalLevel:"LOW",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83D\uDCDD VERBOSE",badgeDisabled:"\uD83D\uDCCB NORMAL",buildTimeImpact:"+12% size",memoryImpact:"+15%",cpuImpact:"+5%",bundleSizeImpact:"+12%",startupTimeImpact:"+200ms"},FEAT_ADVANCED_MONITORING:{flag:"FEAT_ADVANCED_MONITORING",criticalLevel:"MEDIUM",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83D\uDCC8 ADVANCED",badgeDisabled:"\uD83D\uDCCA BASIC",buildTimeImpact:"+7% size",memoryImpact:"+25%",cpuImpact:"+10%",bundleSizeImpact:"+7%",startupTimeImpact:"+500ms"},FEAT_BATCH_PROCESSING:{flag:"FEAT_BATCH_PROCESSING",criticalLevel:"LOW",logHook:"PERFORMANCE_METRIC",badgeEnabled:"\u26A1 BATCH",badgeDisabled:"\uD83D\uDC0C SEQUENTIAL",buildTimeImpact:"+8% size",memoryImpact:"+5%",cpuImpact:"-20%",bundleSizeImpact:"+8%",startupTimeImpact:"+100ms"},FEAT_VALIDATION_STRICT:{flag:"FEAT_VALIDATION_STRICT",criticalLevel:"HIGH",logHook:"FEATURE_CHANGE",badgeEnabled:"\u2705 STRICT",badgeDisabled:"\u26A0\uFE0F LENIENT",buildTimeImpact:"+5% size",memoryImpact:"+5%",cpuImpact:"+3%",bundleSizeImpact:"+5%",startupTimeImpact:"+100ms"},PLATFORM_ANDROID:{flag:"PLATFORM_ANDROID",criticalLevel:"CRITICAL",logHook:"FEATURE_CHANGE",badgeEnabled:"\uD83E\uDD16 ANDROID",badgeDisabled:"\uD83C\uDF4E IOS",buildTimeImpact:"+10% size"},INTEGRATION_GEELARK_API:{flag:"INTEGRATION_GEELARK_API",criticalLevel:"CRITICAL",logHook:"INTEGRATION_EVENT",badgeEnabled:"\uD83D\uDD0C GEELARK API",badgeDisabled:"\uD83D\uDD0C NO API",buildTimeImpact:"+20% size"},INTEGRATION_PROXY_SERVICE:{flag:"INTEGRATION_PROXY_SERVICE",criticalLevel:"MEDIUM",logHook:"INTEGRATION_EVENT",badgeEnabled:"\uD83C\uDF10 PROXY",badgeDisabled:"\uD83D\uDEAB NO PROXY",buildTimeImpact:"+5% size"},INTEGRATION_EMAIL_SERVICE:{flag:"INTEGRATION_EMAIL_SERVICE",criticalLevel:"MEDIUM",logHook:"INTEGRATION_EVENT",badgeEnabled:"\uD83D\uDCE7 EMAIL",badgeDisabled:"\uD83D\uDEAB NO EMAIL",buildTimeImpact:"+3% size"},INTEGRATION_SMS_SERVICE:{flag:"INTEGRATION_SMS_SERVICE",criticalLevel:"MEDIUM",logHook:"INTEGRATION_EVENT",badgeEnabled:"\uD83D\uDCAC SMS",badgeDisabled:"\uD83D\uDEAB NO SMS",buildTimeImpact:"+3% size"}},t=[{type:"Security Critical",triggerCondition:`${"FEAT_ENCRYPTION"} disabled in production`,severity:"CRITICAL",notificationChannels:["SMS","Email","Slack","PagerDuty"],responseTime:"Immediate",autoRecovery:!1,escalationPath:"Security Team"},{type:"Production Warning",triggerCondition:`${"FEAT_MOCK_API"} enabled in production`,severity:"HIGH",notificationChannels:["Email","Slack"],responseTime:"15 minutes",autoRecovery:!0,escalationPath:"DevOps Team"},{type:"Feature Degradation",triggerCondition:">30% features disabled",severity:"MEDIUM",notificationChannels:["Slack","Dashboard"],responseTime:"1 hour",autoRecovery:!0,escalationPath:"Development Team"},{type:"Integration Failure",triggerCondition:"INTEGRATION_* service down >5min",severity:"MEDIUM",notificationChannels:["Email","Slack"],responseTime:"30 minutes",autoRecovery:!0,escalationPath:"Integration Team"},{type:"Performance Alert",triggerCondition:`${"FEAT_BATCH_PROCESSING"} disabled at scale`,severity:"MEDIUM",notificationChannels:["Dashboard only"],responseTime:"2 hours",autoRecovery:!1,escalationPath:"Performance Team"},{type:"Monitoring Gap",triggerCondition:`${"FEAT_ADVANCED_MONITORING"} disabled`,severity:"LOW",notificationChannels:["Dashboard only"],responseTime:"4 hours",autoRecovery:!1,escalationPath:"Monitoring Team"}],g=[{name:"Top Status Bar",displayType:"Text + Emoji",updateFrequency:"Real-time",dataSource:"Feature Registry",widthCalculation:"Bun.stringWidth()",ansiSupport:!0,exportFormats:["JSON","TEXT"]},{name:"Environment Panel",displayType:"Badge Grid",updateFrequency:"On-change",dataSource:"ENV_* flags",widthCalculation:"Grapheme-aware",ansiSupport:!0,exportFormats:["JSON","CSV"]},{name:"Feature Tier Display",displayType:"Large Badge",updateFrequency:"Static",dataSource:"FEAT_PREMIUM",widthCalculation:"Emoji + ZWJ support",ansiSupport:!0,exportFormats:["JSON"]},{name:"Security Status",displayType:"Color-coded",updateFrequency:"Real-time",dataSource:"Security flags",widthCalculation:"Zero-width aware",ansiSupport:!0,exportFormats:["JSON","PDF"]},{name:"Resilience Monitor",displayType:"Icon + Status",updateFrequency:"5 seconds",dataSource:"Auto-heal metrics",widthCalculation:"ANSI sequence aware",ansiSupport:!0,exportFormats:["JSON"]},{name:"Notification Panel",displayType:"Live List",updateFrequency:"1 second",dataSource:"Notification queue",widthCalculation:"Full Unicode",ansiSupport:!0,exportFormats:["JSON","HTML"]},{name:"Performance Graph",displayType:"ASCII/Unicode",updateFrequency:"2 seconds",dataSource:"Performance metrics",widthCalculation:"East Asian width",ansiSupport:!0,exportFormats:["PNG","CSV"]},{name:"Log Viewer",displayType:"Scrolling Text",updateFrequency:"User action",dataSource:"Log buffer",widthCalculation:"Proper wrapping",ansiSupport:!0,exportFormats:["LOG","JSON"]},{name:"Integration Grid",displayType:"Service Icons",updateFrequency:"30 seconds",dataSource:"Health checks",widthCalculation:"Emoji flag support",ansiSupport:!0,exportFormats:["JSON","CSV"]}],r={DEVELOPMENT:{flags:["ENV_DEVELOPMENT","FEAT_EXTENDED_LOGGING","FEAT_MOCK_API"],bundleSize:"450KB",deadCodePercent:"0%",minify:!1,useCase:"Local Development"},PRODUCTION_LITE:{flags:["ENV_PRODUCTION","FEAT_ENCRYPTION"],bundleSize:"320KB",deadCodePercent:"29%",minify:!0,useCase:"Minimal Deployment"},PRODUCTION_STANDARD:{flags:["ENV_PRODUCTION","FEAT_AUTO_HEAL","FEAT_NOTIFICATIONS","FEAT_ENCRYPTION","FEAT_BATCH_PROCESSING"],bundleSize:"280KB",deadCodePercent:"38%",minify:!0,useCase:"Standard Deployment"},PRODUCTION_PREMIUM:{flags:["ENV_PRODUCTION","FEAT_PREMIUM","FEAT_AUTO_HEAL","FEAT_NOTIFICATIONS","FEAT_ENCRYPTION","FEAT_BATCH_PROCESSING","FEAT_ADVANCED_MONITORING","FEAT_EXTENDED_LOGGING","FEAT_VALIDATION_STRICT"],bundleSize:"340KB",deadCodePercent:"24%",minify:!0,useCase:"Premium Deployment"},TEST:{flags:["ENV_DEVELOPMENT","FEAT_MOCK_API"],bundleSize:"180KB",deadCodePercent:"60%",minify:!1,useCase:"CI/CD Testing"},AUDIT:{flags:["ENV_DEVELOPMENT","FEAT_PREMIUM","FEAT_AUTO_HEAL","FEAT_NOTIFICATIONS","FEAT_ENCRYPTION","FEAT_BATCH_PROCESSING","FEAT_ADVANCED_MONITORING","FEAT_EXTENDED_LOGGING","FEAT_VALIDATION_STRICT"],bundleSize:"600KB",deadCodePercent:"0%",minify:!1,useCase:"Security Audit"}};class x{featureRegistry;logger;options;liveUpdateInterval=null;performanceMetrics={memoryUsage:0,cpuUsage:0,responseTime:0,throughput:0,errorRate:0};constructor(E,I,T={}){this.featureRegistry=E;this.logger=I;this.options=T}displayStatus(){this.clearScreen(),this.displayTopStatusBar(),this.displayEnvironmentPanel(),this.displayHealthStatus(),this.displayPerformanceMetrics(),this.displayIntegrationGrid()}displayFullDashboard(){this.clearScreen(),this.displayTopStatusBar(),this.displayEnvironmentPanel(),this.displayFeatureTierDisplay(),this.displaySecurityStatus(),this.displayResilienceMonitor(),this.displayNotificationPanel(),this.displayPerformanceGraph(),this.displayIntegrationGrid(),this.displayAlertStatus()}displayTopStatusBar(){let E=this.featureRegistry.isEnabled("ENV_DEVELOPMENT")?"DEV":"PROD",I=this.calculateHealthStatus(),T=this.featureRegistry.getEnabledCount(),A=this.featureRegistry.getTotalCount(),N=this.getStatusBadge(I.status),R=`${E==="DEV"?"\uD83C\uDF0D DEV":"\uD83C\uDF0D PROD"} ${N} (${T}/${A} features enabled)`,D=this.padLine(R,80);console.log(_.bold.cyan(D)),console.log(_.gray("\u2500".repeat(80))),console.log()}displayEnvironmentPanel(){let E=[];if(this.featureRegistry.isEnabled("FEAT_AUTO_HEAL"))E.push("\uD83D\uDD04 AUTO-HEAL");if(this.featureRegistry.isEnabled("FEAT_NOTIFICATIONS"))E.push("\uD83D\uDD14 ACTIVE");if(this.featureRegistry.isEnabled("FEAT_ENCRYPTION"))E.push("\uD83D\uDD10 ENCRYPTED");if(this.featureRegistry.isEnabled("FEAT_BATCH_PROCESSING"))E.push("\u26A1 BATCH");let I=E.length>0?E.join(" | "):"\u26A0\uFE0F No active features",T=this.padLine(I,80);console.log(_.green(T)),console.log()}displayFeatureTierDisplay(){let E=this.featureRegistry.isEnabled("FEAT_PREMIUM"),I=E?"\uD83C\uDFC6 PREMIUM":"\uD83D\uDD13 FREE",T=E?_.yellow.bold:_.gray,A=`Feature Tier: ${I}`,N=this.padLine(A,80);console.log(T(N)),console.log()}displaySecurityStatus(){let E=[];if(this.featureRegistry.isEnabled("FEAT_ENCRYPTION"))E.push("\uD83D\uDD10 ENCRYPTED");if(this.featureRegistry.isEnabled("FEAT_VALIDATION_STRICT"))E.push("\u2705 STRICT");if(this.featureRegistry.isEnabled("FEAT_EXTENDED_LOGGING"))E.push("\uD83D\uDEE1\uFE0F AUDIT ENABLED");let I=E.length>0?E.join(" | "):"\u26A0\uFE0F Security features disabled",T=this.padLine(I,80);console.log(_.red.bold(T)),console.log()}displayResilienceMonitor(){let E=this.featureRegistry.isEnabled("FEAT_AUTO_HEAL"),I=E?"\uD83D\uDD04 ACTIVE":"\u26A0\uFE0F MANUAL",T=E?_.green:_.yellow,A=`Resilience Monitor: ${I}`,N=this.padLine(A,80);console.log(T(N)),console.log()}displayNotificationPanel(){let E=this.featureRegistry.isEnabled("FEAT_NOTIFICATIONS"),I=E?"\uD83D\uDD14 ACTIVE":"\uD83D\uDD15 SILENT",T=E?_.green:_.gray,A=`Notification Panel: ${I}`,N=this.padLine(A,80);console.log(T(N)),console.log()}displayPerformanceGraph(){let E=this.performanceMetrics.cpuUsage||Math.random()*100,I=this.performanceMetrics.memoryUsage||Math.random()*100,T=this.performanceMetrics.responseTime||Math.random()*100,A=this.createProgressBar(E,10,"\u25B0","\u25B1"),N=this.createProgressBar(I,10,"\u25B0","\u25B1"),O=this.createProgressBar(T/10,10,"\u25B0","\u25B1"),R=`CPU: ${A} ${E.toFixed(0)}% | MEM: ${N} ${I.toFixed(0)}% | RES: ${O} ${T.toFixed(0)}ms`,D=this.padLine(R,80);console.log(_.blue(D)),console.log()}displayIntegrationGrid(){console.log(_.bold.underline("Integration Status:")),console.log(),[{flag:"INTEGRATION_GEELARK_API",name:"GEELARK API",icon:"\uD83D\uDCF1"},{flag:"INTEGRATION_PROXY_SERVICE",name:"PROXY",icon:"\uD83C\uDF10"},{flag:"INTEGRATION_EMAIL_SERVICE",name:"EMAIL",icon:"\uD83D\uDCE7"},{flag:"INTEGRATION_SMS_SERVICE",name:"SMS",icon:"\uD83D\uDCAC"}].forEach((I)=>{let T=this.featureRegistry.isEnabled(I.flag),A=T?"\u2705 HEALTHY":"\u274C DISABLED",N=T?_.green:_.red,O=this.options.ascii?"(1 col)":"(2 cols)",R=`${I.icon} ${I.name}: ${A} ${O}`;console.log(N(R))}),console.log()}displayHealthStatus(E=!1){let I=this.calculateHealthStatus(),T=this.getHealthColor(I.status);if(console.log(T.bold(`Health Status: ${I.badge}`)),console.log(_.gray(`Score: ${I.score}% | Enabled: ${I.enabledPercentage.toFixed(1)}%`)),E){console.log(_.gray(`Critical Features: ${I.criticalFeaturesEnabled?"\u2705 All Enabled":"\u274C Some Disabled"}`));let A=this.featureRegistry.getCriticalFlags();console.log(_.underline(`
Critical Feature Status:`)),A.forEach((N)=>{let O=this.featureRegistry.isEnabled(N),R=O?"\u2705":"\u274C",D=O?_.green:_.red;console.log(D(`  ${R} ${N}`))})}console.log()}displayAlertStatus(){let E=this.getActiveAlerts();if(E.length===0)console.log(_.green("\u2705 No active alerts"));else console.log(_.yellow.bold(`\u26A0\uFE0F ${E.length} Active Alerts:`)),E.forEach((I)=>{let T=this.getAlertColor(I.severity);console.log(T(`  \u2022 ${I.type}: ${I.triggerCondition}`))});console.log()}displayPerformanceMetrics(){this.updatePerformanceMetrics(),console.log(_.bold.underline("Performance Metrics:")),console.log(_.blue(`Memory Usage: ${this.performanceMetrics.memoryUsage.toFixed(1)}%`)),console.log(_.blue(`CPU Usage: ${this.performanceMetrics.cpuUsage.toFixed(1)}%`)),console.log(_.blue(`Response Time: ${this.performanceMetrics.responseTime.toFixed(0)}ms`)),console.log(_.blue(`Throughput: ${this.performanceMetrics.throughput.toFixed(0)} req/s`)),console.log(_.blue(`Error Rate: ${this.performanceMetrics.errorRate.toFixed(2)}%`)),console.log()}startLiveUpdates(E=5000){if(this.liveUpdateInterval)clearInterval(this.liveUpdateInterval);this.liveUpdateInterval=setInterval(()=>{this.displayStatus()},E),console.log(_.green(`\uD83D\uDD04 Live updates started (${E/1000}s interval)`))}stopLiveUpdates(){if(this.liveUpdateInterval)clearInterval(this.liveUpdateInterval),this.liveUpdateInterval=null,console.log(_.yellow("\u23F8\uFE0F Live updates stopped"))}displayComponent(E){let I=g.find((T)=>T.name===E);if(!I){console.error(_.red(`\u274C Unknown component: ${E}`));return}console.log(_.bold(`Component: ${I.name}`)),console.log(_.gray(`Type: ${I.displayType}`)),console.log(_.gray(`Update: ${I.updateFrequency}`)),console.log(_.gray(`Source: ${I.dataSource}`)),console.log(_.gray(`Width: ${I.widthCalculation}`)),console.log(_.gray(`ANSI: ${I.ansiSupport?"\u2705":"\u274C"}`)),console.log(_.gray(`Export: ${I.exportFormats.join(", ")}`))}async export(E){let I={timestamp:new Date().toISOString(),healthStatus:this.calculateHealthStatus(),performanceMetrics:this.performanceMetrics,enabledFeatures:this.featureRegistry.getEnabledFlags(),disabledFeatures:this.featureRegistry.getDisabledFlags()};switch(E.toLowerCase()){case"json":console.log(JSON.stringify(I,null,2));break;case"csv":console.log(this.convertToCSV(I));break;case"html":console.log(this.convertToHTML(I));break;default:console.error(_.red(`\u274C Unsupported export format: ${E}`))}}async checkIntegrationHealth(){console.log(_.bold("\uD83D\uDD0D Checking Integration Health..."));let E=[{flag:"INTEGRATION_GEELARK_API",name:"GeeLark API",endpoint:"/health"},{flag:"INTEGRATION_PROXY_SERVICE",name:"Proxy Service",endpoint:"connection"},{flag:"INTEGRATION_EMAIL_SERVICE",name:"Email Service",endpoint:"smtp"},{flag:"INTEGRATION_SMS_SERVICE",name:"SMS Service",endpoint:"balance"}];for(let I of E)if(this.featureRegistry.isEnabled(I.flag)){console.log(_.blue(`\uD83D\uDD0D Checking ${I.name}...`));let T=Math.random()>0.2,A=T?"\u2705 HEALTHY":"\u274C FAILED",N=T?_.green:_.red;console.log(N(`  ${I.name}: ${A}`))}else console.log(_.gray(`  ${I.name}: \u26A0\uFE0F DISABLED`))}async runSecurityAudit(){console.log(_.bold("\uD83D\uDD12 Running Security Audit..."));let E=[{flag:"FEAT_ENCRYPTION",name:"Encryption",critical:!0},{flag:"FEAT_VALIDATION_STRICT",name:"Strict Validation",critical:!0},{flag:"FEAT_EXTENDED_LOGGING",name:"Audit Logging",critical:!1}],I=!0;if(E.forEach((T)=>{let A=this.featureRegistry.isEnabled(T.flag),N=A?"\u2705 PASS":"\u274C FAIL",O=A?_.green:_.red;if(console.log(O(`  ${T.name}: ${N}${T.critical?" (CRITICAL)":""}`)),T.critical&&!A)I=!1}),console.log(),I)console.log(_.green.bold("\u2705 Security Audit PASSED"));else console.log(_.red.bold("\u274C Security Audit FAILED - Critical issues detected"))}async runFullAudit(E=!1){if(console.log(_.bold("\uD83D\uDD0D Running Full System Audit...")),await this.runSecurityAudit(),await this.checkIntegrationHealth(),console.log(_.bold(`
\uD83D\uDCCA Feature Flag Audit:`)),this.featureRegistry.getAllFlags().forEach((T)=>{let A=this.featureRegistry.isEnabled(T),N=this.featureRegistry.getFlagConfig(T),O=A?"\u2705":"\u274C",R=A?_.green:_.red;console.log(R(`  ${O} ${T} (${N?.criticalLevel||"UNKNOWN"})`))}),E)console.log(_.bold(`
\uD83D\uDC1B Debug Information:`)),console.log(_.gray(`  Total Features: ${this.featureRegistry.getTotalCount()}`)),console.log(_.gray(`  Enabled Features: ${this.featureRegistry.getEnabledCount()}`)),console.log(_.gray(`  Health Score: ${this.calculateHealthStatus().score}%`))}async reviewPerformance(E=!1){if(console.log(_.bold("\uD83D\uDCC8 Performance Review...")),this.updatePerformanceMetrics(),this.displayPerformanceMetrics(),E){if(console.log(_.bold(`
\uD83D\uDCA1 Optimization Suggestions:`)),this.performanceMetrics.memoryUsage>80)console.log(_.yellow("  \u2022 Consider disabling FEAT_EXTENDED_LOGGING to reduce memory usage"));if(this.performanceMetrics.cpuUsage>80)console.log(_.yellow("  \u2022 Consider enabling FEAT_BATCH_PROCESSING to reduce CPU load"));if(this.performanceMetrics.responseTime>100)console.log(_.yellow("  \u2022 Consider enabling FEAT_AUTO_HEAL for better response times"));if(!this.featureRegistry.isEnabled("FEAT_ADVANCED_MONITORING"))console.log(_.blue("  \u2022 Enable FEAT_ADVANCED_MONITORING for better performance insights"))}}async runSystemReview(){console.log(_.bold("\uD83D\uDD0D System Review...")),await this.reviewPerformance(!0),await this.runSecurityAudit(),await this.checkIntegrationHealth();let E=this.calculateHealthStatus();console.log(_.bold(`
\uD83D\uDCCA Overall System Health: ${E.badge}`))}async optimizeBuild(){console.log(_.bold("\uD83D\uDD28 Optimizing Build..."));let E=this.featureRegistry.getEnabledFlags(),I=[];if(E.includes("FEAT_MOCK_API")&&this.featureRegistry.isEnabled("ENV_PRODUCTION"))I.push("Remove FEAT_MOCK_API from production builds");if(!E.includes("FEAT_BATCH_PROCESSING")&&this.featureRegistry.getEnabledCount()>10)I.push("Enable FEAT_BATCH_PROCESSING for better performance at scale");if(E.includes("FEAT_EXTENDED_LOGGING")&&this.featureRegistry.isEnabled("ENV_PRODUCTION"))I.push("Consider reducing FEAT_EXTENDED_LOGGING in production");if(I.length>0)console.log(_.yellow("\uD83D\uDCA1 Optimization Suggestions:")),I.forEach((T)=>console.log(_.yellow(`  \u2022 ${T}`)));else console.log(_.green("\u2705 Build is already optimized"))}async analyzeBuild(){console.log(_.bold("\uD83D\uDCCA Analyzing Build Composition..."));let E=this.featureRegistry.getEnabledFlags(),I=this.calculateBundleSize(E),T=this.calculateDeadCodePercentage(E);console.log(_.blue(`Estimated Bundle Size: ${I}`)),console.log(_.blue(`Dead Code Elimination: ${T}%`)),console.log(_.bold(`
\uD83D\uDCE6 Feature Breakdown:`)),E.forEach((A)=>{let O=this.featureRegistry.getFlagConfig(A)?.buildTimeImpact||"Unknown";console.log(_.gray(`  \u2022 ${A}: ${O}`))})}async generateAuditReport(E){let I={timestamp:new Date().toISOString(),healthStatus:this.calculateHealthStatus(),performanceMetrics:this.performanceMetrics,securityAudit:await this.runSecurityAudit(),integrationHealth:await this.checkIntegrationHealth(),featureFlags:{enabled:this.featureRegistry.getEnabledFlags(),disabled:this.featureRegistry.getDisabledFlags(),total:this.featureRegistry.getTotalCount()}};switch(E.toLowerCase()){case"json":console.log(JSON.stringify(I,null,2));break;case"pdf":console.log(_.yellow("PDF export not yet implemented"));break;default:console.error(_.red(`\u274C Unsupported report format: ${E}`))}}startMonitoring(){console.log(_.green("\uD83D\uDCCA Advanced monitoring started"))}clearScreen(){console.clear()}padLine(E,I){let T=this.options.ascii?E.length:$.calculate(E),A=Math.max(0,I-T);return E+" ".repeat(A)}createProgressBar(E,I,T,A){let N=Math.round(E/100*I);return T.repeat(N)+A.repeat(I-N)}calculateHealthStatus(){let E=this.featureRegistry.getEnabledCount(),I=this.featureRegistry.getTotalCount(),T=E/I*100,A=this.featureRegistry.getCriticalFlags(),O=A.filter((S)=>this.featureRegistry.isEnabled(S)).length===A.length,R,D,M;if(T>=90&&O)R="HEALTHY",D="\u2705 HEALTHY",M=T;else if(T>=70)R="DEGRADED",D="\u26A0\uFE0F DEGRADED",M=T;else if(T>=50)R="IMPAIRED",D="\uD83D\uDD04 IMPAIRED",M=T;else if(T>0)R="CRITICAL",D="\uD83D\uDEA8 CRITICAL",M=T;else R="OFFLINE",D="\uD83D\uDC80 OFFLINE",M=0;return{status:R,badge:D,score:M,enabledPercentage:T,criticalFeaturesEnabled:O,color:this.getHealthColor(R)}}getHealthColor(E){switch(E){case"HEALTHY":return _.green;case"DEGRADED":return _.yellow;case"IMPAIRED":return _.hex("#fd7e14");case"CRITICAL":return _.red;case"OFFLINE":return _.gray;default:return _.white}}getAlertColor(E){switch(E){case"CRITICAL":return _.red.bold;case"HIGH":return _.red;case"MEDIUM":return _.yellow;case"LOW":return _.blue;default:return _.white}}getStatusBadge(E){switch(E){case"HEALTHY":return"\u2705 HEALTHY";case"DEGRADED":return"\u26A0\uFE0F DEGRADED";case"IMPAIRED":return"\uD83D\uDD04 IMPAIRED";case"CRITICAL":return"\uD83D\uDEA8 CRITICAL";case"OFFLINE":return"\uD83D\uDC80 OFFLINE";default:return"\u2753 UNKNOWN"}}getActiveAlerts(){return t.filter((E)=>this.isAlertTriggered(E))}isAlertTriggered(E){if(E.triggerCondition.includes("FEAT_ENCRYPTION"))return!this.featureRegistry.isEnabled("FEAT_ENCRYPTION")&&this.featureRegistry.isEnabled("ENV_PRODUCTION");if(E.triggerCondition.includes("FEAT_MOCK_API"))return this.featureRegistry.isEnabled("FEAT_MOCK_API")&&this.featureRegistry.isEnabled("ENV_PRODUCTION");if(E.triggerCondition.includes(">30% features disabled"))return this.featureRegistry.getEnabledCount()/this.featureRegistry.getTotalCount()*100<70;return!1}updatePerformanceMetrics(){this.performanceMetrics={memoryUsage:Math.random()*100,cpuUsage:Math.random()*100,responseTime:Math.random()*200,throughput:Math.random()*1000,errorRate:Math.random()*5}}calculateBundleSize(E){let T={FEAT_EXTENDED_LOGGING:50,FEAT_ADVANCED_MONITORING:30,FEAT_ENCRYPTION:20,FEAT_AUTO_HEAL:25,FEAT_NOTIFICATIONS:15},A=200;return E.forEach((N)=>{A+=T[N]||10}),`${A}KB`}calculateDeadCodePercentage(E){let I=Object.keys(V).length,T=E.length;return Math.round((I-T)/I*100)}convertToCSV(E){return`timestamp,healthScore,memoryUsage,cpuUsage
${E.timestamp},${E.healthStatus.score},${E.performanceMetrics.memoryUsage},${E.performanceMetrics.cpuUsage}`}convertToHTML(E){return`
<!DOCTYPE html>
<html>
<head><title>Dashboard Report</title></head>
<body>
  <h1>Dashboard Report</h1>
  <p>Generated: ${E.timestamp}</p>
  <h2>Health Status</h2>
  <p>Score: ${E.healthStatus.score}%</p>
  <p>Status: ${E.healthStatus.status}</p>
  <h2>Performance Metrics</h2>
  <p>Memory: ${E.performanceMetrics.memoryUsage}%</p>
  <p>CPU: ${E.performanceMetrics.cpuUsage}%</p>
</body>
</html>`}}class J{flags=new Map;configs=new Map;changeListeners=[];constructor(E){Object.values(V).forEach((I)=>{let T=j[I];if(T)this.configs.set(I,{...T,enabled:E?.[I]??this.getDefaultState(I)}),this.flags.set(I,E?.[I]??this.getDefaultState(I))})}getDefaultState(E){if(E==="ENV_DEVELOPMENT")return!0;if(E==="ENV_PRODUCTION")return!1;if(E==="PLATFORM_ANDROID")return!0;if(this.isEnabled("ENV_DEVELOPMENT"))return!0;let I=j[E];return I?.criticalLevel==="CRITICAL"||I?.criticalLevel==="PROD_CRITICAL"}isEnabled(E){return this.flags.get(E)??!1}enable(E){if(this.flags.get(E)!==!0)this.flags.set(E,!0),this.updateConfig(E,!0),this.notifyChange(E,!0)}disable(E){if(this.flags.get(E)!==!1)this.flags.set(E,!1),this.updateConfig(E,!1),this.notifyChange(E,!1)}toggle(E){if(this.isEnabled(E))this.disable(E);else this.enable(E)}set(E,I){if(I)this.enable(E);else this.disable(E)}updateConfig(E,I){let T=this.configs.get(E);if(T)T.enabled=I}notifyChange(E,I){this.changeListeners.forEach((T)=>T(E,I))}onChange(E){this.changeListeners.push(E)}offChange(E){let I=this.changeListeners.indexOf(E);if(I>-1)this.changeListeners.splice(I,1)}getConfig(E){return this.configs.get(E)}getAllFlags(){return Array.from(this.flags.keys())}getEnabledFlags(){return Array.from(this.flags.entries()).filter(([E,I])=>I).map(([E,I])=>E)}getDisabledFlags(){return Array.from(this.flags.entries()).filter(([E,I])=>!I).map(([E,I])=>E)}getCriticalFlags(){return Array.from(this.configs.entries()).filter(([E,I])=>I.criticalLevel==="CRITICAL"||I.criticalLevel==="PROD_CRITICAL").map(([E,I])=>E)}getHealthStatus(){let E=this.getAllFlags(),I=this.getEnabledFlags(),T=this.getCriticalFlags(),A=T.filter((S)=>this.isEnabled(S)),N=I.length/E.length*100,O=A.length===T.length,R,D,M;if(N>=90)R="HEALTHY",D="#28a745",M="\u2705 HEALTHY";else if(N>=70)R="DEGRADED",D="#ffc107",M="\u26A0\uFE0F DEGRADED";else if(N>=50)R="IMPAIRED",D="#fd7e14",M="\uD83D\uDD04 IMPAIRED";else if(N>0)R="CRITICAL",D="#dc3545",M="\uD83D\uDEA8 CRITICAL";else R="OFFLINE",D="#343a40",M="\uD83D\uDC80 OFFLINE";return{score:Math.round(N),status:R,color:D,badge:M,enabledPercentage:Math.round(N),criticalFeaturesEnabled:O}}getBadge(E){let I=this.configs.get(E);if(!I)return"\u2753 UNKNOWN";return this.isEnabled(E)?I.badgeEnabled:I.badgeDisabled}getStatusSummary(){let E=this.getHealthStatus(),I=this.getEnabledFlags().length,T=this.getAllFlags().length;return`${E.badge} (${I}/${T} features enabled)`}exportState(){let E={};return this.flags.forEach((I,T)=>{E[T]=I}),E}importState(E){Object.entries(E).forEach(([I,T])=>{if(Object.values(V).includes(I))this.set(I,T)})}resetToDefaults(){this.flags.clear(),this.configs.clear(),Object.values(V).forEach((E)=>{let I=j[E];if(I){let T=this.getDefaultState(E);this.configs.set(E,{...I,enabled:T}),this.flags.set(E,T)}})}enableFeature(E){this.enable(E)}disableFeature(E){this.disable(E)}toggleFeature(E){this.toggle(E)}getEnabledCount(){return this.getEnabledFlags().length}getTotalCount(){return this.getAllFlags().length}getFlagConfig(E){return this.getConfig(E)}rotateFlags(){this.getAllFlags().filter((I)=>{let T=this.getConfig(I);return T&&T.criticalLevel!=="CRITICAL"&&T.criticalLevel!=="PROD_CRITICAL"}).forEach((I)=>{if(Math.random()>0.5)this.toggle(I)})}displayAllFlags(){console.log("Feature Flag Status:"),console.log("=".repeat(50)),this.getAllFlags().forEach((I)=>{let T=this.isEnabled(I),A=this.getConfig(I),N=this.getBadge(I),O=A?.criticalLevel||"UNKNOWN",R=T?"\u2705":"\u274C",D=T?"\x1B[32m":"\x1B[31m",M="\x1B[0m";console.log(`${D}${R} ${I}\x1B[0m - ${N} (${O})`)});let E=this.getHealthStatus();console.log("=".repeat(50)),console.log(`Overall Status: ${E.badge} (${E.score}% enabled)`)}}class p{logs=[];maxLogs=1000;featureRegistry;externalServices=new Map;level="INFO";retention=30;constructor(E={}){this.featureRegistry=E.featureRegistry||new J({}),this.level=E.level||"INFO",this.retention=E.retention||30,this.initializeExternalServices()}initializeExternalServices(){this.externalServices.set("elasticsearch",async(E)=>{if(this.featureRegistry.isEnabled("FEAT_EXTENDED_LOGGING"))console.log(`[ES] ${E.level}: ${E.message}`)}),this.externalServices.set("splunk",async(E)=>{if(E.type==="SECURITY_EVENT")console.log(`[SPLUNK] ${E.level}: ${E.message}`)}),this.externalServices.set("datadog",async(E)=>{if(E.type==="INTEGRATION_EVENT")console.log(`[DD] ${E.level}: ${E.message}`)}),this.externalServices.set("prometheus",async(E)=>{if(E.type==="PERFORMANCE_METRIC")console.log(`[PROM] ${E.level}: ${E.message}`)}),this.externalServices.set("sentry",async(E)=>{if(E.type==="ERROR_OCCURRED")console.log(`[SENTRY] ${E.level}: ${E.message}`)}),this.externalServices.set("cloudwatch",async(E)=>{if(E.type==="HEALTH_CHECK")console.log(`[CW] ${E.level}: ${E.message}`)})}getLogPrefix(E){return{FEATURE_CHANGE:"\u2139\uFE0F [FEATURE]",SECURITY_EVENT:"\uD83D\uDD12 [SECURITY]",INTEGRATION_EVENT:"\uD83D\uDD0C [INTEGRATION]",PERFORMANCE_METRIC:"\u26A1 [PERF]",ERROR_OCCURRED:"\u274C [ERROR]",AUDIT_TRAIL:"\uD83D\uDCCB [AUDIT]",HEALTH_CHECK:"\u2764\uFE0F [HEALTH]"}[E]||"[UNKNOWN]"}getRetentionDays(E){return{FEATURE_CHANGE:7,SECURITY_EVENT:90,INTEGRATION_EVENT:30,PERFORMANCE_METRIC:30,ERROR_OCCURRED:30,AUDIT_TRAIL:365,HEALTH_CHECK:7}[E]||30}async log(E,I,T,A){let N={type:E,level:I,message:T,timestamp:new Date,data:A,prefix:this.getLogPrefix(E)};if(this.logs.push(N),this.logs.length>this.maxLogs)this.logs.shift();let O=`${N.prefix} ${N.message}`;if(this.consoleOutput(N.level,O),await this.sendToExternalServices(N),E==="FEATURE_CHANGE")this.featureRegistry.onChange((R,D)=>{this.log("FEATURE_CHANGE","INFO",`Feature ${R} ${D?"enabled":"disabled"}`,{flag:R,enabled:D})})}consoleOutput(E,I){let T=new Date().toISOString();switch(E){case"DEBUG":console.debug(`[${T}] ${I}`);break;case"INFO":console.info(`[${T}] ${I}`);break;case"WARN":console.warn(`[${T}] ${I}`);break;case"ERROR":console.error(`[${T}] ${I}`);break;case"CRITICAL":console.error(`[${T}] \uD83D\uDEA8 CRITICAL: ${I}`);break}}async sendToExternalServices(E){let I=[];for(let[T,A]of this.externalServices)I.push(A(E).catch((N)=>{console.error(`Failed to send log to ${T}:`,N)}));await Promise.allSettled(I)}async featureChange(E,I){await this.log("FEATURE_CHANGE","INFO",E,I)}async securityEvent(E,I){await this.log("SECURITY_EVENT","CRITICAL",E,I)}async integrationEvent(E,I){await this.log("INTEGRATION_EVENT","INFO",E,I)}async performanceMetric(E,I){await this.log("PERFORMANCE_METRIC","DEBUG",E,I)}async error(E,I){await this.log("ERROR_OCCURRED","ERROR",E,I)}async audit(E,I){await this.log("AUDIT_TRAIL","INFO",E,I)}async healthCheck(E,I){await this.log("HEALTH_CHECK","INFO",E,I)}async info(E,I){await this.log("FEATURE_CHANGE","INFO",E,I)}async critical(E,I){await this.log("SECURITY_EVENT","CRITICAL",E,I)}getLogs(E,I,T){let A=this.logs;if(E)A=A.filter((N)=>N.type===E);if(I)A=A.filter((N)=>N.level===I);if(T)A=A.slice(-T);return A}getRecentLogs(E=60){let I=new Date(Date.now()-E*60*1000);return this.logs.filter((T)=>T.timestamp>=I)}getLogsByFeature(E){return this.logs.filter((I)=>I.data?.flag===E||I.message.includes(E))}clearLogs(){this.logs=[]}exportLogs(E="json"){switch(E){case"json":return JSON.stringify(this.logs,null,2);case"csv":let I=["timestamp","type","level","message","prefix"],T=this.logs.map((A)=>[A.timestamp.toISOString(),A.type,A.level,A.message,A.prefix]);return[I,...T].map((A)=>A.join(",")).join(`
`);case"text":return this.logs.map((A)=>`${A.timestamp.toISOString()} ${A.prefix} ${A.message}`).join(`
`);default:return""}}getLogStats(){let E={},I={};return Object.values(Z).forEach((T)=>E[T]=0),Object.values(m).forEach((T)=>I[T]=0),this.logs.forEach((T)=>{E[T.type]++,I[T.level]++}),{total:this.logs.length,byType:E,byLevel:I,oldest:this.logs.length>0?this.logs[0].timestamp:null,newest:this.logs.length>0?this.logs[this.logs.length-1].timestamp:null}}tailLogs(){console.log("\uD83D\uDCCB Tailing logs (Press Ctrl+C to stop)...");let E=setInterval(()=>{let I=this.getRecentLogs(1);if(I.length>0)I.forEach((T)=>{console.log(`${T.prefix} ${T.message}`)})},1000);if(typeof process<"u")process.on("SIGINT",()=>{clearInterval(E),console.log(`
\uD83D\uDCCB Log tailing stopped`)})}displayLogs(E){console.log(`\uD83D\uDCCB Displaying ${E.length} logs:`),console.log("=".repeat(80)),E.forEach((I)=>{let T=I.timestamp.toISOString(),A=this.getLevelColor(I.level),N="\x1B[0m";console.log(`${A}[${T}] ${I.prefix} ${I.message}\x1B[0m`)}),console.log("=".repeat(80))}async exportLogsToFormat(E,I){let T;switch(I.toLowerCase()){case"json":T=JSON.stringify(E,null,2);break;case"csv":let A=["timestamp","type","level","message","prefix"],N=E.map((O)=>[O.timestamp.toISOString(),O.type,O.level,O.message,O.prefix]);T=[A,...N].map((O)=>O.join(",")).join(`
`);break;default:console.error(`\u274C Unsupported export format: ${I}`);return}console.log(T)}getLevelColor(E){switch(E){case"DEBUG":return"\x1B[36m";case"INFO":return"\x1B[32m";case"WARN":return"\x1B[33m";case"ERROR":return"\x1B[31m";case"CRITICAL":return"\x1B[35m";default:return"\x1B[0m"}}}class F{featureRegistry;logger;dashboard;config;constructor(E={}){this.config=this.initializeConfig(E),this.featureRegistry=new J(this.config.featureFlags),this.logger=new p({level:E.verbose?"DEBUG":this.config.logging.level,externalServices:this.config.logging.externalServices,retention:this.config.logging.retention}),this.dashboard=new x(this.featureRegistry,this.logger,{ascii:E.ascii||!1}),this.logger.info("Phone Management System initialized",{environment:this.config.environment,platform:this.config.platform,buildType:this.config.buildType,featuresEnabled:Array.from(this.config.featureFlags.entries()).filter(([I,T])=>T).length})}initializeConfig(E){let I=E.environment||"production",T=E.platform||(process.env.PLATFORM==="ios"?"IOS":"ANDROID"),A=E.buildType||"DEVELOPMENT";if(process.env.BUILD_TYPE){let R=process.env.BUILD_TYPE;A=Q[R]||"DEVELOPMENT"}let N=r[A],O=new Map;if(N.flags.forEach((R)=>{O.set(R,!0)}),I==="production")O.set("ENV_PRODUCTION",!0),O.set("ENV_DEVELOPMENT",!1);else O.set("ENV_DEVELOPMENT",!0),O.set("ENV_PRODUCTION",!1);if(T==="ANDROID")O.set("PLATFORM_ANDROID",!0);return{environment:I,platform:T,buildType:A,featureFlags:O,apiEndpoints:{geelark:process.env.GEELARK_BASE_URL,proxy:process.env.PROXY_SERVICE_URL,email:process.env.EMAIL_SERVICE_URL,sms:process.env.SMS_SERVICE_URL},logging:{level:process.env.LOG_LEVEL||"INFO",externalServices:process.env.EXTERNAL_LOGGING==="true"?["elasticsearch","splunk","datadog","prometheus","sentry","cloudwatch"]:[],retention:parseInt(process.env.LOG_RETENTION_DAYS||"30")},security:{encryption:O.get("FEAT_ENCRYPTION")||!1,validation:process.env.VALIDATION_MODE||"strict",auditTrail:O.get("FEAT_EXTENDED_LOGGING")||!1},monitoring:{advanced:O.get("FEAT_ADVANCED_MONITORING")||!1,notifications:O.get("FEAT_NOTIFICATIONS")||!1,healthChecks:!0}}}async run(E){let I=E[0]||"status";try{switch(I){case"status":await this.handleStatusCommand(E.slice(1));break;case"dashboard":await this.handleDashboardCommand(E.slice(1));break;case"health":await this.handleHealthCommand(E.slice(1));break;case"logs":await this.handleLogsCommand(E.slice(1));break;case"flags":await this.handleFlagsCommand(E.slice(1));break;case"audit":await this.handleAuditCommand(E.slice(1));break;case"review":await this.handleReviewCommand(E.slice(1));break;case"build":await this.handleBuildCommand(E.slice(1));break;case"start":await this.handleStartCommand(E.slice(1));break;default:console.error(`Unknown command: ${I}`),this.showHelp(),process.exit(1)}}catch(T){this.logger.error(`Command failed: ${I}`,{error:T.message,stack:T.stack}),console.error(`Error: ${T.message}`),process.exit(1)}}async handleStatusCommand(E){let I=E.includes("--watch"),T=E.find((A)=>A.startsWith("--interval="))?.split("=")[1]||"5";if(I){let A=parseInt(T)*1000;this.dashboard.startLiveUpdates(A),process.on("SIGINT",()=>{this.dashboard.stopLiveUpdates(),process.exit(0)}),await new Promise(()=>{})}else this.dashboard.displayStatus()}async handleDashboardCommand(E){let I=E.findIndex((A)=>A==="--component"),T=E.findIndex((A)=>A==="--export");if(I!==-1&&E[I+1])this.dashboard.displayComponent(E[I+1]);else if(T!==-1&&E[T+1])await this.dashboard.export(E[T+1]);else this.dashboard.displayFullDashboard()}async handleHealthCommand(E){let I=E.includes("--integrations"),T=E.includes("--detailed");if(I)await this.dashboard.checkIntegrationHealth();else this.dashboard.displayHealthStatus(T)}async handleLogsCommand(E){let I=E.findIndex((R)=>R==="--type"),T=E.findIndex((R)=>R==="--level"),A=E.findIndex((R)=>R==="--since"),N=E.findIndex((R)=>R==="--export");if(E.includes("--tail"))this.logger.tailLogs();else{let R=I!==-1?E[I+1]:void 0,D=T!==-1?E[T+1]:void 0,M=A!==-1?E[A+1]:void 0,S=N!==-1?E[N+1]:void 0,k=this.logger.getLogs(R);if(S)await this.logger.exportLogs(k,S);else this.logger.displayLogs(k)}}async handleFlagsCommand(E){let I=E.includes("--list"),T=E.findIndex((D)=>D==="--enable"),A=E.findIndex((D)=>D==="--disable"),N=E.findIndex((D)=>D==="--toggle"),O=E.includes("--reset"),R=E.includes("--rotate");if(I)this.featureRegistry.displayAllFlags();else if(T!==-1&&E[T+1]){let D=V[E[T+1]];if(D)this.featureRegistry.enableFeature(D),console.log(`\u2705 Enabled ${D}`);else console.error(`\u274C Unknown feature flag: ${E[T+1]}`)}else if(A!==-1&&E[A+1]){let D=V[E[A+1]];if(D)this.featureRegistry.disableFeature(D),console.log(`\u274C Disabled ${D}`);else console.error(`\u274C Unknown feature flag: ${E[A+1]}`)}else if(N!==-1&&E[N+1]){let D=V[E[N+1]];if(D){this.featureRegistry.toggleFeature(D);let M=this.featureRegistry.isEnabled(D)?"enabled":"disabled";console.log(`${M==="enabled"?"\u2705":"\u274C"} ${D} ${M}`)}else console.error(`\u274C Unknown feature flag: ${E[N+1]}`)}else if(O)this.featureRegistry.resetToDefaults(),console.log("\uD83D\uDD04 All feature flags reset to defaults");else if(R)this.featureRegistry.rotateFlags(),console.log("\uD83D\uDD04 Feature flags rotated for maintenance");else this.featureRegistry.displayAllFlags()}async handleAuditCommand(E){let I=E.includes("--security"),T=E.includes("--full"),A=E.findIndex((N)=>N==="--report");if(console.log("\uD83D\uDD0D Running system audit..."),I)await this.dashboard.runSecurityAudit();else await this.dashboard.runFullAudit(T);if(A!==-1&&E[A+1])await this.dashboard.generateAuditReport(E[A+1])}async handleReviewCommand(E){let I=E.includes("--performance"),T=E.includes("--optimize");if(I)await this.dashboard.reviewPerformance(T);else await this.dashboard.runSystemReview()}async handleBuildCommand(E){let I=E.includes("--optimize"),T=E.includes("--analyze");if(I)await this.dashboard.optimizeBuild();else if(T)await this.dashboard.analyzeBuild();else console.log("\uD83D\uDD28 Building system..."),console.log("\u2705 Build completed successfully")}async handleStartCommand(E){let I=E.findIndex((N)=>N==="--port"),T=E.includes("--mock"),A=I!==-1?parseInt(E[I+1]):3000;if(T)this.featureRegistry.enableFeature("FEAT_MOCK_API");if(console.log("\uD83D\uDE80 Starting Phone Management System..."),console.log(`\u2705 System started on port ${A}`),this.dashboard.displayStatus(),this.config.monitoring.advanced)this.dashboard.startMonitoring();await new Promise(()=>{})}showHelp(){console.log(`
Phone Management System - Comprehensive phone management with feature flags

Usage: phone-management-system <command> [options]

Commands:
  status          Display real-time system status
  dashboard       Display comprehensive system dashboard
  health          Check system health and integration status
  logs            View and filter system logs
  flags           Manage feature flags
  audit           Run security and compliance audits
  review          Review system performance and metrics
  build           Build system with optimization
  start           Start the phone management system

Options:
  --help          Show this help message
  --verbose       Enable verbose logging
  --dry-run       Execute in dry-run mode
  --ascii         Force ASCII mode for dashboard
  --no-color      Disable colored output

For detailed help on each command, use:
  phone-management-system <command> --help
    `)}getFeatureRegistry(){return this.featureRegistry}getLogger(){return this.logger}getDashboard(){return this.dashboard}getConfig(){return this.config}}if(import.meta.main){let E=process.argv.slice(2);new F({verbose:E.includes("--verbose"),dryRun:E.includes("--dry-run"),ascii:E.includes("--ascii")}).run(E).catch((T)=>{console.error("Fatal error:",T),process.exit(1)})}var OI=F;export{OI as default,F as PhoneManagementSystem};

//# debugId=DAC74E914E1FA81B64756E2164756E21
//# sourceMappingURL=production.js.map
