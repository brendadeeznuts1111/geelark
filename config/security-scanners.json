{
  "snyk": {
    "enabled": true,
    "severityThreshold": "high",
    "failOn": ["upgradable", "patchable"],
    "scanTypes": ["code", "openSource", "container", "iac"],
    "excludedPaths": [
      "node_modules",
      "dist",
      ".git",
      ".github",
      ".vscode",
      ".devcontainer"
    ],
    "policies": {
      "production": {
        "critical": "block",
        "high": "block",
        "medium": "warn",
        "low": "info"
      },
      "development": {
        "critical": "block",
        "high": "warn",
        "medium": "info",
        "low": "info"
      }
    }
  },
  "trivy": {
    "enabled": true,
    "scanTypes": ["vulnerability", "secret", "misconfiguration"],
    "severities": ["CRITICAL", "HIGH"],
    "ignoreUnfixed": false,
    "outputFormats": ["table", "json"],
    "targets": {
      "container": ".devcontainer/Dockerfile",
      "filesystem": ".",
      "repository": "."
    }
  },
  "bandit": {
    "enabled": true,
    "profile": "all",
    "severityLevel": "high",
    "confidenceLevel": "high",
    "excludedPaths": ["node_modules", "dist", ".git"],
    "checks": {
      "sqlInjection": true,
      "commandInjection": true,
      "pathTraversal": true,
      "xss": true,
      "hardcodedSecrets": true
    }
  },
  "grype": {
    "enabled": true,
    "scope": "all-layers",
    "onlyFixed": false,
    "failOn": ["critical", "high"],
    "outputFormats": ["table", "json", "cyclonedx"],
    "exclusions": [
      "CVE-2024-12345", // Example exclusion
      "GHSA-xxxx-xxxx-xxxx"
    ]
  },
  "trufflehog": {
    "enabled": true,
    "scanDepth": 50,
    "onlyVerified": true,
    "excludedPaths": [
      "node_modules",
      "dist",
      ".git",
      "package-lock.json",
      "yarn.lock",
      "bun.lock"
    ],
    "detectors": [
      "aws",
      "github",
      "google",
      "slack",
      "stripe",
      "generic"
    ],
    "severityThreshold": "high"
  },
  "dependencyCheck": {
    "enabled": true,
    "formats": ["HTML", "JSON", "SARIF"],
    "suppressionFile": "config/security-suppressions.xml",
    "scanSet": "ALL",
    "failOnCVSS": 7.0,
    "analyzer": {
      "centralEnabled": true,
      "nexusEnabled": false,
      "npmAuditEnabled": true,
      "bundleAuditEnabled": true
    }
  },
  "licenseCompliance": {
    "enabled": true,
    "allowedLicenses": [
      "MIT",
      "ISC",
      "Apache-2.0",
      "BSD-2-Clause",
      "BSD-3-Clause",
      "Unlicense",
      "0BSD",
      "CC0-1.0"
    ],
    "restrictedLicenses": [
      "GPL-2.0",
      "GPL-3.0",
      "AGPL-3.0",
      "LGPL-2.1",
      "LGPL-3.0"
    ],
    "forbiddenLicenses": [
      "SSPL-1.0",
      "JSON"
    ],
    "policy": {
      "production": "strict",
      "development": "permissive",
      "testing": "permissive"
    }
  },
  "featureFlagSecurity": {
    "enabled": true,
    "rules": [
      {
        "name": "no-mock-in-production",
        "condition": "ENV_PRODUCTION && FEAT_MOCK_API",
        "severity": "critical",
        "action": "block",
        "message": "Mock API cannot be enabled in production environment"
      },
      {
        "name": "encryption-required-in-production",
        "condition": "ENV_PRODUCTION && !FEAT_ENCRYPTION",
        "severity": "critical",
        "action": "block",
        "message": "Encryption must be enabled in production environment"
      },
      {
        "name": "strict-validation-required",
        "condition": "ENV_PRODUCTION && !FEAT_VALIDATION_STRICT",
        "severity": "high",
        "action": "warn",
        "message": "Strict validation recommended in production"
      },
      {
        "name": "premium-with-monitoring",
        "condition": "FEAT_PREMIUM && !FEAT_ADVANCED_MONITORING",
        "severity": "medium",
        "action": "warn",
        "message": "Premium features should have advanced monitoring"
      }
    ],
    "validationLevels": {
      "critical": ["FEAT_ENCRYPTION", "FEAT_VALIDATION_STRICT"],
      "high": ["FEAT_AUTO_HEAL", "FEAT_NOTIFICATIONS"],
      "medium": ["FEAT_PREMIUM", "FEAT_ADVANCED_MONITORING"],
      "low": ["FEAT_EXTENDED_LOGGING", "FEAT_BATCH_PROCESSING"]
    }
  },
  "scanSchedule": {
    "daily": {
      "enabled": true,
      "time": "02:00",
      "scanners": ["snyk", "dependencyCheck"]
    },
    "weekly": {
      "enabled": true,
      "day": "sunday",
      "time": "03:00",
      "scanners": ["trivy", "grype", "trufflehog", "licenseCompliance"]
    },
    "onPush": {
      "enabled": true,
      "scanners": ["snyk", "trufflehog", "featureFlagSecurity"]
    },
    "onPR": {
      "enabled": true,
      "scanners": ["snyk", "bandit", "featureFlagSecurity", "dependencyCheck"]
    }
  },
  "reporting": {
    "outputFormats": ["json", "html", "markdown", "sarif"],
    "destinations": {
      "console": true,
      "file": "reports/security-scan-{{timestamp}}.json",
      "slack": true,
      "email": false,
      "webhook": false
    },
    "aggregation": {
      "enabled": true,
      "interval": "weekly",
      "format": "dashboard"
    }
  },
  "integration": {
    "ciCd": {
      "githubActions": true,
      "gitlabCi": false,
      "jenkins": false,
      "circleCi": false
    },
    "monitoring": {
      "datadog": false,
      "splunk": false,
      "elasticsearch": false,
      "prometheus": true
    },
    "notification": {
      "slack": true,
      "email": false,
      "teams": false,
      "pagerduty": false
    }
  }
}
